# 🔍 تحليل الملفات المحتاجة تحسين - bThwaniApp

## 📊 ملخص سريع

تم تحديد **47 ملف** يحتاج تحسين في تغطية الاختبارات من أصل **108 ملف** مختبر.

---

## 🚨 الملفات ذات التغطية المنخفضة جداً (أقل من 10%)

### 1. **Screens/Auth** - 4.08% تغطية
```
📁 screens/Auth/
├── ForgotPasswordScreen.tsx     (8.69% تغطية)
├── LoginScreen.tsx              (5.14% تغطية)
├── OTPVerificationScreen.tsx    (1.86% تغطية)
├── RegisterScreen.tsx           (3.29% تغطية)
├── ResetNewPasswordScreen.tsx   (7.69% تغطية)
└── ResetVerifyScreen.tsx        (3.44% تغطية)
```

**المشكلة**: شاشات المصادقة أساسية للتطبيق ولكن تغطيتها منخفضة جداً.

### 2. **Screens/Profile** - 3.8% تغطية
```
📁 screens/profile/
├── DeliveryAddressesScreen.tsx  (1.58% تغطية)
├── EditProfileScreen.tsx        (3.63% تغطية)
├── SettingsScreen.tsx           (11.11% تغطية)
└── UserProfileScreen.tsx        (5.45% تغطية)
```

**المشكلة**: شاشات الملف الشخصي مهمة للمستخدمين ولكن غير مختبرة.

### 3. **Screens/Wallet** - 8.69% تغطية
```
📁 screens/wallet/
├── CouponListScreen.tsx         (8.57% تغطية)
├── LoyaltyScreen.tsx            (4.34% تغطية)
├── TransactionDetailsScreen.tsx (50% تغطية)
├── WalletScreen.tsx             (9.52% تغطية)
├── WithdrawScreen.tsx           (6.25% تغطية)
└── analytics.tsx                (5.55% تغطية)
```

**المشكلة**: شاشات المحفظة تحتوي على منطق مالي معقد يحتاج اختبار شامل.

### 4. **Components** - 41.86% تغطية
```
📁 components/
├── DynamicFAB.tsx               (7.69% تغطية)
├── ScheduledDeliveryPicker.tsx  (2.77% تغطية)
├── FAQSection.tsx               (73.91% تغطية)
├── FloatingCartButton.tsx       (75% تغطية)
├── RatingModal.tsx              (61.11% تغطية)
└── ui/
    ├── button.tsx               (0% تغطية)
    ├── card.tsx                 (0% تغطية)
    └── input.tsx                (0% تغطية)
```

**المشكلة**: مكونات UI الأساسية غير مختبرة.

---

## ⚠️ الملفات ذات التغطية المتوسطة (10-50%)

### 1. **Screens/Delivery** - 18.98% تغطية
```
📁 screens/delivery/
├── BusinessDetailsScreen.tsx    (38.94% تغطية)
├── CartScreen.tsx               (7.69% تغطية)
├── CategoryDetailsScreen.tsx    (2.06% تغطية)
├── DeliveryDriverOrdersScreen.tsx (7.4% تغطية)
├── DeliveryHomeScreen.tsx       (40% تغطية)
├── DeliverySearch.tsx           (63.63% تغطية)
├── GroceryScreen.tsx            (28.42% تغطية)
├── InvoiceScreen.tsx            (4.08% تغطية)
├── MyOrdersScreen.tsx           (13.95% تغطية)
├── OrderDetailsScreen.tsx       (25% تغطية)
├── ProductDetailsScreen.tsx     (10% تغطية)
├── SHEINScreen.tsx              (57.14% تغطية)
└── SheinCheckoutScreen.tsx      (38.46% تغطية)
```

### 2. **Screens/Map** - 6.14% تغطية
```
📁 screens/map/
└── SelectLocationScreen.tsx     (6.14% تغطية)
```

### 3. **Utils** - 81.04% تغطية (جيد ولكن يحتاج تحسين)
```
📁 utils/
├── offlineQueue.ts              (17.64% تغطية)
├── opportunitiesStorage.ts      (40% تغطية)
├── toastConfig.tsx              (0% تغطية)
└── api/
    ├── axiosInstance.ts         (18.18% تغطية)
    └── uploadFileToBunny.ts     (0% تغطية)
```

---

## 🎯 أولويات التحسين

### الأولوية العالية 🔴
1. **شاشات المصادقة** - أساسية للأمان
2. **شاشات المحفظة** - تحتوي على منطق مالي
3. **مكونات UI الأساسية** - مستخدمة في كل مكان

### الأولوية المتوسطة 🟡
1. **شاشات التسوق** - تجربة المستخدم الأساسية
2. **شاشات الملف الشخصي** - مهمة للمستخدمين
3. **أدوات API** - أساسية للاتصال بالخادم

### الأولوية المنخفضة 🟢
1. **شاشات الخريطة** - ميزة إضافية
2. **أدوات مساعدة** - تغطيتها جيدة نسبياً

---

## 📋 خطة التحسين المفصلة

### الأسبوع الأول: شاشات المصادقة
```typescript
// إضافة اختبارات لـ LoginScreen
describe('LoginScreen', () => {
  test('يجب أن يعرض نموذج تسجيل الدخول', () => {});
  test('يجب أن يتحقق من صحة البريد الإلكتروني', () => {});
  test('يجب أن يتحقق من صحة كلمة المرور', () => {});
  test('يجب أن يتعامل مع أخطاء تسجيل الدخول', () => {});
  test('يجب أن ينتقل لشاشة إعادة تعيين كلمة المرور', () => {});
});
```

### الأسبوع الثاني: شاشات المحفظة
```typescript
// إضافة اختبارات لـ WalletScreen
describe('WalletScreen', () => {
  test('يجب أن يعرض رصيد المحفظة', () => {});
  test('يجب أن يعرض تاريخ المعاملات', () => {});
  test('يجب أن يتعامل مع أخطاء تحميل البيانات', () => {});
  test('يجب أن ينتقل لشاشة الشحن', () => {});
  test('يجب أن ينتقل لشاشة السحب', () => {});
});
```

### الأسبوع الثالث: مكونات UI
```typescript
// إضافة اختبارات لـ Button Component
describe('Button', () => {
  test('يجب أن يعرض النص المطلوب', () => {});
  test('يجب أن يستجيب للنقر', () => {});
  test('يجب أن يعرض حالة التحميل', () => {});
  test('يجب أن يكون معطل عند الحاجة', () => {});
});
```

---

## 🔧 أدوات التحسين المقترحة

### 1. **Jest Coverage Badge**
```bash
npm install --save-dev jest-coverage-badge
```

### 2. **Coverage Thresholds**
```javascript
// jest.config.js
coverageThreshold: {
  global: {
    branches: 70,
    functions: 70,
    lines: 70,
    statements: 70,
  },
  './src/screens/Auth/': {
    branches: 80,
    functions: 80,
    lines: 80,
    statements: 80,
  },
}
```

### 3. **Test Utilities**
```typescript
// src/test-utils/testHelpers.ts
export const renderWithProviders = (component: React.ReactElement) => {
  return render(
    <ThemeProvider>
      <CartProvider>
        {component}
      </CartProvider>
    </ThemeProvider>
  );
};
```

---

## 📊 أهداف التحسين

### الأهداف قصيرة المدى (شهر واحد)
- [ ] الوصول لتغطية 50% للشاشات
- [ ] الوصول لتغطية 60% للمكونات
- [ ] إصلاح جميع أخطاء Syntax

### الأهداف متوسطة المدى (3 أشهر)
- [ ] الوصول لتغطية 70% كحد أدنى
- [ ] إضافة اختبارات E2E
- [ ] تحسين سرعة الاختبارات

### الأهداف طويلة المدى (6 أشهر)
- [ ] الوصول لتغطية 80% كحد أدنى
- [ ] إضافة اختبارات الأداء
- [ ] إضافة اختبارات إمكانية الوصول

---

## 🎯 مؤشرات النجاح

### مؤشرات كمية
- **تغطية الشاشات**: من 67% إلى 80%
- **تغطية المكونات**: من 42% إلى 70%
- **تغطية الأدوات**: من 81% إلى 90%

### مؤشرات نوعية
- **جودة الاختبارات**: اختبارات واضحة ومفهومة
- **سرعة الاختبارات**: أقل من 30 ثانية
- **استقرار الاختبارات**: 100% نجاح

---

*تم إنشاء هذا التحليل في: ${new Date().toLocaleDateString('ar-SA')}*

