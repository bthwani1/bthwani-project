#!/bin/bash

# =====================================
# ููู ุงูุจูุงุก ูุงูุฑูุน ููุงุณุชุถุงูุฉ
# =====================================

echo "๐ ุจุฏุก ุนูููุฉ ุงูุจูุงุก ูุงูุฑูุน..."

# ุชูุธูู ุงููุฌูุฏุงุช ุงูุณุงุจูุฉ
echo "๐งน ุชูุธูู ุงููุฌูุฏุงุช ุงูุณุงุจูุฉ..."
rm -rf dist
rm -rf build

# ุชุซุจูุช ุงูุชุจุนูุงุช
echo "๐ฆ ุชุซุจูุช ุงูุชุจุนูุงุช..."
npm install

# ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ
echo "๐จ ุจูุงุก ุงููุดุฑูุน ููุฅูุชุงุฌ..."
npm run build

# ุงูุชุญูู ูู ูุฌุงุญ ุงูุจูุงุก
if [ ! -d "dist" ]; then
    echo "โ ูุดู ูู ุงูุจูุงุก!"
    exit 1
fi

echo "โ ุชู ุงูุจูุงุก ุจูุฌุงุญ!"

# ุนุฑุถ ุญุฌู ุงููููุงุช
echo "๐ ุญุฌู ุงููููุงุช:"
du -sh dist/*

# ูุณุฎ ูููุงุช ุฅุถุงููุฉ ูููุฉ
echo "๐ ูุณุฎ ุงููููุงุช ุงูุฅุถุงููุฉ..."
cp public/.htaccess dist/
cp public/robots.txt dist/
cp public/sitemap.xml dist/

# ุฅูุดุงุก ููู ูุนูููุงุช ุงูุจูุงุก
echo "๐ ุฅูุดุงุก ููู ูุนูููุงุช ุงูุจูุงุก..."
echo "Build Date: $(date)" > dist/build-info.txt
echo "Build Version: $(git rev-parse --short HEAD 2>/dev/null || echo 'unknown')" >> dist/build-info.txt
echo "Node Version: $(node --version)" >> dist-build-info.txt
echo "NPM Version: $(npm --version)" >> dist/build-info.txt

echo "๐ ุชู ุฅุนุฏุงุฏ ุงููููุงุช ููุฑูุน!"
echo ""
echo "๐ ูุฌูุฏ dist ุฌุงูุฒ ููุฑูุน ุฅูู ุงูุงุณุชุถุงูุฉ"
echo "๐ ุงููููุงุช ุงููุทููุจุฉ:"
echo "   - dist/ (ุงููุฌูุฏ ุงูุฑุฆูุณู)"
echo "   - .htaccess (ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู)"
echo "   - robots.txt (SEO)"
echo "   - sitemap.xml (SEO)"
echo ""
echo "๐ก ูุตุงุฆุญ ููุฑูุน:"
echo "   1. ุงุฑูุน ูุญุชููุงุช ูุฌูุฏ dist ุฅูู ุงููุฌูุฏ ุงูุฌุฐุฑ ูููููุน"
echo "   2. ุชุฃูุฏ ูู ูุฌูุฏ ููู .htaccess"
echo "   3. ุชุฃูุฏ ูู ุชูุนูู mod_rewrite ุนูู ุงูุฎุงุฏู"
echo "   4. ุงุฎุชุจุฑ ุงูุฑูุงุจุท ุจุนุฏ ุงูุฑูุน"
echo ""
echo "๐ ุฑูุงุจุท ูููุฉ ููุงุฎุชุจุงุฑ:"
echo "   - ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ: /"
echo "   - ุงูุฎุฏูุงุช: /services"
echo "   - ููุชุฌุงุฑ: /for-merchants"
echo "   - ูููุจุงุชู: /become-captain"
echo "   - ุงูุฏุนู: /support"
echo "   - ูู ูุญู: /about"
echo "   - ุงูุชูุงุตู: /contact"
